# CPRテンポ練習ゲーム仕様書（子供向けイベント用）

## 名称
CPRテンポトレーナー（CPR Tempo Trainer）

---

## 概要
子供たちが楽しく学べるCPR（心肺蘇生）における胸骨圧迫のテンポ（100BPM）を、リズムゲームとして体験・練習できるWebアプリケーションです。  
YouTube動画を見ながらスペースキーを押す動作で胸骨圧迫を模倣し、正確なテンポを維持できればクリア、ずれた場合はゲームオーバーになります。

---

## 対象ユーザー
- 小学生〜中学生（イベント来場者）
- CPRを楽しみながら体験してもらう目的
- 医療従事者の補助指導にも使用可

---

## 使用環境
- モダンなWebブラウザ（Chrome、Firefox、Safari、Edgeなど）
- インターネット接続（YouTube動画の再生に必要）
- キーボード（スペースキーを使用）
- スマートフォン・タブレットでも動作（タップ操作対応）

---

## 基準テンポ
- 標準テンポ：**BPM100**
- 許容範囲：±10（BPM90〜110）
- ゲームオーバー判定：±20（BPM80未満 or BPM120超）

---

## ゲームの流れ

### 1. ウォームアップ（計測モード）
- スペースキーを**8回連続で押す**
- 平均テンポを測定
- 許容範囲内（BPM90〜110）ならゲームスタート
- ずれていたら再トライ

### 2. ゲーム開始（再生モード）
- 選択したYouTube動画が再生される
- リズムに合わせてスペースキーを押す
- テンポがずれるとリアルタイムにフィードバックが表示される
- 一定以上ずれるとゲームオーバー

### 3. クリア条件
- 動画の再生終了までテンポを維持できればクリア
- 最後にスコア表示（平均BPM、最小/最大BPM、タップ回数などの統計情報）

---

## 機能要件

### 入力
- スペースキーで圧迫を模倣
- 押下のタイミングをリアルタイムに記録

### 処理
- 押下間隔からBPMを算出
- YouTube Player APIによる動画再生制御
- リアルタイムなテンポ計算とフィードバック

### 出力
- 現在のテンポ表示（リアルタイム）
- テンポインジケーター（視覚的フィードバック）
- YouTube動画の再生
- テキストによるフィードバック（「もう少し速く」「良いテンポです」など）
- 結果判定（ゲームオーバー / クリア）
- 終了後の統計情報表示

---

## 技術スタック
- HTML5 / CSS3
- JavaScript（ES6+）
- YouTube Player API
- ローカルストレージ（動画選択情報の保存）

---

## ファイル構成

### HTML
- `index.html` - 動画選択画面
  - ユーザーがトレーニングに使用するYouTube動画を選択する画面
  - 動画選択後、プレイ画面に遷移

- `play.html` - ゲームプレイ画面
  - ウォームアップ、テンポトレーニング、結果表示の各タブを含む
  - YouTube動画の再生とテンポトレーニング機能を提供

### CSS
- `css/style.css` - 共通スタイル
  - アプリ全体のレイアウトとデザイン
  - タブ、ボタン、フィードバック表示などのスタイル

- `css/video-selection.css` - 動画選択画面用スタイル
  - 動画選択グリッドとカードのスタイル

### JavaScript
- `js/main.js` - メイン処理
  - アプリの初期化とページ判定
  - イベントリスナーの設定
  - ページ間の遷移とデータ受け渡し
  - localStorageを使用した動画選択情報の保存と読み込み

- `js/video-data.js` - 動画データ管理
  - トレーニング用動画のデータ定義
  - 動画のID、タイトル、サムネイル、難易度などの情報管理

- `js/tempo-trainer.js` - テンポトレーナーのコア機能
  - ウォームアップとテンポトレーニングのロジック
  - BPM計算とフィードバック表示
  - ゲーム状態管理と結果判定
  - テンポインジケーターの制御

- `js/youtube-api.js` - YouTube Player APIのラッパー
  - YouTube IFrame APIの初期化と設定
  - 動画の読み込み、再生、一時停止などの制御
  - プレーヤーイベントのハンドリング

---

## 拡張アイデア（任意）
- カスタムYouTube動画のURL入力機能
- 難易度設定（許容範囲の調整）
- ユーザーごとの統計データの保存と表示
- アニメーション効果の強化
- 多言語対応
- モバイル向け操作の最適化
- PWA（Progressive Web App）対応
